#!/usr/bin/env ruby

class Song

LEXICON = [
  {thing: 'the house', action: 'that Jack built'},
  {thing: 'the malt', action: 'that lay in'},
  {thing: 'the rat', action: 'that ate'},
  {thing: 'the cat', action: 'that killed'},
  {thing: 'the dog', action: 'that worried'},
  {thing: 'the cow with the crumpled horn', action: 'that tossed'},
  {thing: 'the maiden all forlorn', action: 'that milked'},
  {thing: 'the man all tattered and torn', action: 'that kissed'},
  {thing: 'the priest all shaven and shorn', action: 'that married'},
  {thing: 'the rooster that crowed in the morn', action: 'that woke'},
  {thing: 'the farmer sowing his corn', action: 'that kept'},
  {thing: 'the horse and the hound and the horn', action: 'that belonged to'},
]

  def sing
    out = ''
    0.upto(11) do |n|
      out = out + "#{line(n)}\n\n"
    end
    puts out
  end

  def line(verse)
    line = 'This is'
    verse.downto(0).each do |n|
      stanza = LEXICON[n]
      line = line + " #{stanza[:thing]} #{stanza[:action]}"
    end
    "#{line}."
  end

end

Song.new.sing

